<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="UTF-8" />
		<title>Duck &mdash; Go outside and play it!</title>

		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<meta name="theme-color" content="#FDFF8E" />

		<link rel="manifest" href="/site.webmanifest" />
		<link
			rel="apple-touch-icon"
			sizes="180x180"
			href="favicons/apple-touch-icon.png"
		/>
		<link
			rel="icon"
			type="image/png"
			sizes="32x32"
			href="favicons/favicon-32x32.png"
		/>
		<link
			rel="icon"
			type="image/png"
			sizes="16x16"
			href="favicons/favicon-16x16.png"
		/>
		<link
			rel="mask-icon"
			href="favicons/safari-pinned-tab.svg"
			color="#3d7af0"
		/>

		<style>
			@font-face {
				font-family: 'Livvic';
				src: url('assets/fonts/livvic/livvic-bold.woff2')
						format('woff2'),
					url('assets/fonts/livvic/livvic-bold.woff') format('woff');
				font-weight: bold;
				font-style: normal;
			}

			@font-face {
				font-family: 'Livvic';
				src: url('assets/fonts/livvic/livvic-medium.woff2')
						format('woff2'),
					url('assets/fonts/livvic/livvic-medium.woff') format('woff');
				font-weight: normal;
				font-style: normal;
			}

			@font-face {
				font-family: 'Literata';
				src: url('assets/fonts/literata/literata-bold.woff2')
						format('woff2'),
					url('assets/fonts/literata/literata-bold.woff')
						format('woff');
				font-weight: bold;
				font-style: normal;
			}
		</style>
		<link media="all" rel="stylesheet" href="style.css" />
	</head>
	<body>
		<img
			src="assets/images/duck-seal.png"
			srcset="
				assets/images/duck-seal.png,
				assets/images/duck-seal@2x.png 2x
			"
			alt="An oval seal containing the words Play Duck and below it, a cartoon-style pencil drawing of a mallard duck on a blue background"
			class="logo"
		/>
		<header>
			<p class="byline">Duck</p>
			<h1 aria-live="polite" aria-atomic="false">
				A social game to play with your
				<span id="js-who">friends</span>
				<span id="js-where">in the park</span><span id="js-dot">.</span>
			</h1>
		</header>

		<section>
			<h2>How to play</h2>
			<ol>
				<li>
					Gather your companion(s)!
					<img
						class="guide-image"
						src="assets/images/gathering-duck-friends.png"
						srcset="
							assets/images/gathering-duck-friends.png,
							assets/images/gathering-duck-friends@2x.png 2x
						"
					/>
				</li>
				<li>
					Roam the outdoors!
					<img
						class="guide-image"
						src="assets/images/roam-the-outdoors.png"
						srcset="
							assets/images/roam-the-outdoors.png,
							assets/images/roam-the-outdoors@2x.png 2x
						"
					/>
				</li>
				<li>
					When you spot a duck, be the first to shout
					&ldquo;Duck&rdquo;!
					<img
						class="guide-image"
						src="assets/images/spot-a-duck.png"
						srcset="
							assets/images/spot-a-duck.png,
							assets/images/spot-a-duck@2x.png 2x
						"
					/>
				</li>
				<li>
					Were you first? Congrats, you are today&rsquo;s winner of
					Duck!
					<img
						class="guide-image"
						src="assets/images/win-duck.png"
						srcset="
							assets/images/win-duck.png,
							assets/images/win-duck@2x.png 2x
						"
					/>
				</li>
				<li>
					Was someone else faster? Don&rsquo;t brood: Tomorrow is
					another chance to win Duck.
					<img
						class="guide-image"
						src="assets/images/try-another-day.png"
						srcset="assets/images/try-another-day.png, assets/images/try-another-day@2x 2x.png"
					/>
				</li>
			</ol>
		</section>

		<section>
			<h2>Questions &amp; Answers</h2>

			<h3>Wait, that&rsquo;s it? Where do I download the app?</h3>
			<p>
				That&rsquo;s it. There&rsquo;s no app to download and you
				don&rsquo;t even need your phone. It does help to live near a
				pond or a river, because ducks like those.
			</p>

			<h3>
				I saw a duck and yelled <em>Duck!</em> as fast as I could. Turns
				out it wasn&rsquo;t a duck, but a cheeky moorhen with very large
				feet! I think it sneered at me, too.
			</h3>
			<p>
				Sorry, that means you lost the game for today. Part of the game
				is making sure that you really spotted a duck before you make
				the claim.
			</p>
			<p>
				If you were playing with a single partner, they automatically
				won and you should buy them an ice cream.
			</p>

			<h3>
				I&rsquo;m pretty sure that&rsquo;s a duck over there, but
				it&rsquo;s hard to tell from a distance. It could be a bottle.
				Should I call it?
			</h3>
			<p>
				Is the bottle dipping its head into the water every now and then
				and gathering in small groups? If so, it might be a good bet!
			</p>
			<p>
				Otherwise, ask your companions if they agree that you&rsquo;re
				looking at a duck. You can make the rules as loose or strict as
				you want.
			</p>

			<h3>Where I live, no ducks venture. Can I still play Duck?</h3>
			<p>
				Sure, just pick another local animal! It should be one
				that&rsquo;s common enough that you&rsquo;re quite likely
				&ndash; but not guaranteed &ndash; to see one when you venture
				outside.
			</p>

			<h3>So you really think I should give this game a try?</h3>
			<p>
				Well, now that you know the rules, you may find it hard to
				resist the urge to shout <em>Duck!</em> every time you see one.
				But worry not, as there are many of us. Pairs, handfuls, if not
				half a dozens!
			</p>
			<p>
				If you have played and enjoyed this game (or not), I&rsquo;d
				love to hear about your experience. You can place your message
				in a bottle, seal it securely, and release it into a body of
				water near you, or
				<a href="mailto:mail@diondiondion.com">send me an email</a>.
			</p>
		</section>
		<aside class="cookie-notice small">
			<h2 class="small-heading">Cookie notice</h2>
			<p>
				Ducks will happily eat cookies and other bread-like substances,
				but
				<a
					href="https://phys.org/news/2021-01-bread-home-ducks-science.html"
					>they&rsquo;re not good for them</a
				>!
			</p>
			<p>
				So please don&rsquo;t feed a duck a cookie. This website
				doesn&rsquo;t use them, either.
			</p>
			<div class="button-row" id="js-confirm-buttons"></div>
			<template id="js-confirm-buttons-template">
				<button class="button js-confirm-notice"></button>
			</template>
		</aside>
		<footer>
			Created by
			<a rel="author" href="https://diondiondion.com">Dion Dajka</a>
			ðŸ¦†
		</footer>
		<script>
			// UTILS

			function range(length) {
				const output = [];
				for (let i = 0; i < length; i += 1) {
					output.push(i);
				}
				return output;
			}

			function createRandomSequence(length) {
				const array = range(length);
				let currentIndex = length;
				let temporaryValue;
				let randomIndex;

				// While there remain elements to shuffle...
				while (0 !== currentIndex) {
					// Create a random index to pick from the array
					randomIndex = Math.floor(Math.random() * currentIndex);
					currentIndex -= 1;

					// Cache the value, and swap it with the current element
					temporaryValue = array[currentIndex];
					array[currentIndex] = array[randomIndex];
					array[randomIndex] = temporaryValue;
				}

				return array;
			}

			// Get random, non-repeating element from array
			const rrCache = {};
			function roundRobin(key, array) {
				// Create a sequence of random numbers at the provided
				// key if there isn't one yet, or if it's empty
				if (!rrCache[key] || rrCache[key].length === 0) {
					rrCache[key] = createRandomSequence(array.length);
				}

				// Pick & remove the first element from the sequence
				const [randomIndex] = rrCache[key].splice(0, 1);

				// Return an item from the array at the extracted index
				return array[randomIndex];
			}

			// DATA

			const whos = [
				'friends',
				'family',
				'pen pal',
				'colleagues',
				'nephew',
				'seven nieces',
				'grandma',
				'grandchildren',
				'triplets',
				'librarian',
				'ex-boyfriend',
				'kebab guy',
				'drug dealer',
				'tax accountant',
				'neighbours',
				'team',
				'lover',
				'best friend',
				'soulmate',
				'children',
				'local gang',
				'band',
				'dog',
				'weird acquaintance from yoga',
			];

			const wheres = [
				'in the park',
				'in the woods',
				'in the city',
				'by the river',
				'by the lake',
				'by the sea',
				'in the zoo',
				'on a walk',
				'on a hike',
				'on a rooftop',
				'on a holiday',
				'on your honeymoon',
				'on horseback',
				'on a boat',
				'at lunch time',
				'in the morning',
				'in the evening',
				'at any time of day',
				'starting today',
				'for the rest of your lives',
				'via text',
				'eating ice creams',
			];

			// Progressive enhancement: Add JS-only button
			const buttonContainer = document.getElementById('js-dot');
			const button = document.createElement('button');
			button.setAttribute('type', 'button');
			button.classList.add('link');
			button.appendChild(document.createTextNode('orâ€¦'));
			buttonContainer.textContent = ', ';
			buttonContainer.appendChild(button);

			const whoContainer = document.getElementById('js-who');
			const whereContainer = document.getElementById('js-where');

			function randomise() {
				whoContainer.textContent = roundRobin('who', whos);
				whereContainer.textContent = roundRobin('where', wheres);
			}

			button.addEventListener('click', randomise);

			/*
			 * FAKE COOKIE BANNER
			 */

			const cookieButtonWrapper =
				document.getElementById('js-confirm-buttons');

			const buttonTemplate = document.getElementById(
				'js-confirm-buttons-template'
			).content.firstElementChild;

			function confirmCookieNotice(event) {
				console.log(event.target.dataset);
				cookieButtonWrapper.textContent = event.target.dataset.response;
			}

			const cookieButtons = [
				{
					label: 'I accept',
					response: 'Thanks!',
				},
				{
					label: 'I agree',
					response: 'Thanks!',
				},
				{
					label: 'I love ducks',
					response: 'Thanks! We love them too!',
				},
			];

			cookieButtons.forEach((data) => {
				const button = buttonTemplate.cloneNode();
				button.textContent = data.label;
				button.setAttribute('data-response', data.response);
				button.addEventListener('click', confirmCookieNotice);
				cookieButtonWrapper.appendChild(button);
			});
		</script>
	</body>
</html>
